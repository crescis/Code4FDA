# Code4FDA
This repository contains the code and data files for “Simultaneous Clustering and Optimization in Function-on-Scalar Regression.”

Raw inputs were obtained from the EPA Outdoor Air Quality Data ([https://www.epa.gov/outdoor-air-quality-data]) and the ICPSR archive ([https://www.icpsr.umich.edu/web/pages/]). We include the cleaned, analysis-ready datasets in the `data/` folder.

The implementation spans MATLAB and R: all algorithmic development and core results are produced in MATLAB, while data analysis and visualization are handled in R.


Part 1. MATLAB implementation
The spADMM algorithm is written in MATLAB. Real-data AQI analysis is driven by `AQI_analysis.m`, which leverages a suite of functions in the `main_algorithm_spADMM/` directory. Baseline and competing methods live in `other methods/`. Preprocessing relies on the third-party FDA toolbox `fdaM/`, which is bundled for convenience. 
Within `AQI_analysis.m` (and its supporting `.m` files), we sweep across various parameter settings and export each experiment’s results to CSV for downstream use in R. Depending on your MATLAB release, you may need additional toolboxes (e.g., GPR, GPML, or Curve Fitting)—see the in-code comments for details.



Part 2. R scripts
All data statistical analysis and visualization are carried out in R. The R scripts consume the CSV outputs generated by MATLAB (via `AQI_analysis.m`)  to reproduce the figures, tables, and summary statistics presented in the paper.

